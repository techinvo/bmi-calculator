<!DOCTYPE html>
<html lang="th">

<head>
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö kg/lb</title>
    <meta name="description" id="pageDescription"
        content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">
    <meta name="keywords" content="BMI, ‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢, ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å, ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á, kg, lb, metric, imperial">
    <meta name="author" content="BMI Calculator Pro">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" id="ogTitle" content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö kg/lb">
    <meta property="og:description" id="ogDescription"
        content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=BMI+Calculator+Pro">
    <meta property="og:url" content="">
    <meta property="og:site_name" content="BMI Calculator Pro">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitterTitle" content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ">
    <meta name="twitter:description" id="twitterDescription"
        content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=BMI+Calculator+Pro">
    
    <meta name="google-site-verification" content="D_B-sEyK5FsNqKwTHZPNgixqH-hQNY8YXOILJ4GaWaM" />

    <!-- PWA Manifest -->
    <link rel="manifest"
        href="data:application/json;base64,ewogICJuYW1lIjogIkJNSSBDYWxjdWxhdG9yIFBybyIsCiAgInNob3J0X25hbWUiOiAiQk1JIENhbGMiLAogICJkZXNjcmlwdGlvbiI6ICJBZHZhbmNlZCBCTUkgQ2FsY3VsYXRvciB3aXRoIE11bHRpLUxhbmd1YWdlIFN1cHBvcnQiLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzRGNDZFNSIsCiAgInRoZW1lX2NvbG9yIjogIiM0RjQ2RTUiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdkbWxsZDBKdmVEMGlNQ0F3SURJMU5pQXlOVFlpSUdacGJHdzlJaU0wUmpRMlJUVWlQZ29nSUNBZ1BHTnBjbU5zWlNCamVEMGlNVEk0SWlCamVUMGlNVEk0SWlCeVBTSTRNQ0lnWm1sc2JEMGlJell4TlRZMVJVVWlMejRLUEM5emRtYyssCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <meta name="theme-color" content="#4F46E5">

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9072108391482416"
        crossorigin="anonymous"></script>

    

    <!-- Custom CSS -->
    <style>
        .fade-in {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease-in-out;
        }

        .fade-in.show {
            opacity: 1;
            transform: translateY(0);
        }

        .unit-toggle,
        .lang-toggle {
            transition: all 0.3s ease;
        }

        .unit-toggle.active,
        .lang-toggle.active {
            background-color: #4F46E5;
            color: white;
        }

        #bmiChart {
            max-height: 250px;
        }

        .share-button,
        .action-button {
            transition: all 0.2s ease;
        }

        .share-button:hover,
        .action-button:hover {
            transform: translateY(-2px);
        }

        .history-item {
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background-color: #f8fafc;
        }

        .comparison-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .install-prompt {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt hidden">
        <div class="bg-indigo-600 text-white p-4 rounded-lg shadow-lg max-w-sm">
            <div class="flex items-center justify-between mb-2">
                <span class="font-semibold" data-i18n="installApp">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ</span>
                <button onclick="hideInstallPrompt()" class="text-white hover:text-gray-200">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <p class="text-sm mb-3" data-i18n="installAppDesc">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô</p>
            <button onclick="installPWA()"
                class="bg-white text-indigo-600 px-4 py-2 rounded font-medium text-sm w-full">
                <span data-i18n="install">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</span>
            </button>
        </div>
    </div>

    <!-- Header Section -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <div class="text-center flex-1">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2" data-i18n="mainTitle">üè• ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
                        BMI Pro</h1>
                    <p class="text-gray-600 text-sm sm:text-base" data-i18n="mainSubtitle">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô
                        ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch</p>
                </div>

                <!-- Language Toggle -->
                <div class="flex bg-gray-100 rounded-lg p-1">
                    <button id="thBtn" class="lang-toggle active px-3 py-1 rounded-md font-medium text-sm"
                        onclick="switchLanguage('th')">
                        üáπüá≠ TH
                    </button>
                    <button id="enBtn" class="lang-toggle px-3 py-1 rounded-md font-medium text-sm"
                        onclick="switchLanguage('en')">
                        üá¨üáß EN
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- BMI Calculator Section -->
        <section class="bg-white rounded-xl shadow-lg p-6 sm:p-8 mb-8" id="calculator-section">
            <div class="text-center mb-6">
                <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-2" data-i18n="calcTitle">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                </h2>
                <p class="text-gray-600" data-i18n="calcSubtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</p>
            </div>

            <!-- Unit Toggle -->
            <div class="flex justify-center mb-6">
                <div class="bg-gray-100 rounded-lg p-1 flex">
                    <button id="metricBtn" class="unit-toggle active px-4 py-2 rounded-md font-medium text-sm"
                        onclick="switchUnit('metric')">
                        kg / cm
                    </button>
                    <button id="imperialBtn" class="unit-toggle px-4 py-2 rounded-md font-medium text-sm"
                        onclick="switchUnit('imperial')">
                        lb / ft/in
                    </button>
                </div>
            </div>

            <!-- Input Form -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column: Inputs -->
                <div class="space-y-6">
                    <!-- Weight Input -->
                    <div class="space-y-2">
                        <label for="weight" class="block text-sm font-medium text-gray-700" id="weightLabel"
                            data-i18n="weightLabel">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)</label>
                        <input type="number" id="weight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 65" min="1" max="500" step="0.1"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                    </div>

                    <!-- Height Input (Metric) -->
                    <div id="metricHeight" class="space-y-2">
                        <label for="height" class="block text-sm font-medium text-gray-700"
                            data-i18n="heightLabel">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£)</label>
                        <input type="number" id="height" placeholder="‡πÄ‡∏ä‡πà‡∏ô 170" min="50" max="300" step="0.1"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                    </div>

                    <!-- Height Input (Imperial) -->
                    <div id="imperialHeight" class="space-y-2 hidden">
                        <label class="block text-sm font-medium text-gray-700"
                            data-i18n="heightImperialLabel">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á</label>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="number" id="heightFeet" data-i18n-placeholder="feetPlaceholder"
                                placeholder="‡∏ü‡∏∏‡∏ï" min="3" max="9" step="1"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                            <input type="number" id="heightInches" data-i18n-placeholder="inchesPlaceholder"
                                placeholder="‡∏ô‡∏¥‡πâ‡∏ß" min="0" max="11" step="0.1"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                        </div>
                    </div>

                    <!-- Optional Info -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label for="gender" class="block text-sm font-medium text-gray-700"
                                data-i18n="genderLabel">‡πÄ‡∏û‡∏® (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                            <select id="gender"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                                <option value="" data-i18n="selectGender">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
                                <option value="male" data-i18n="male">‡∏ä‡∏≤‡∏¢</option>
                                <option value="female" data-i18n="female">‡∏´‡∏ç‡∏¥‡∏á</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label for="age" class="block text-sm font-medium text-gray-700" data-i18n="ageLabel">‡∏≠‡∏≤‡∏¢‡∏∏
                                (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                            <input type="number" id="age" data-i18n-placeholder="agePlaceholder" placeholder="‡∏õ‡∏µ"
                                min="1" max="120" step="1"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors">
                        </div>
                    </div>

                    <!-- Calculate Button -->
                    <div class="text-center">
                        <button id="calculateBtn" onclick="calculateBMI()"
                            class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-lg transition-colors duration-300 shadow-md hover:shadow-lg w-full sm:w-auto"
                            data-i18n="calculateBtn">
                            ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI
                        </button>
                    </div>
                </div>

                <!-- Right Column: BMI Reference Table -->
                <div class="space-y-6">
                    <h3 class="text-lg font-semibold text-gray-800 text-center" data-i18n="bmiTableTitle">
                        ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤ BMI</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse border border-gray-300 rounded-lg overflow-hidden">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700"
                                        data-i18n="bmiRange">‡∏Ñ‡πà‡∏≤ BMI</th>
                                    <th class="border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700"
                                        data-i18n="interpretation">‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr class="bg-blue-50">
                                    <td class="border border-gray-300 px-4 py-3 font-medium">&lt; 18.5</td>
                                    <td class="border border-gray-300 px-4 py-3 text-blue-700" data-i18n="underweight">
                                        ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</td>
                                </tr>
                                <tr class="bg-green-50">
                                    <td class="border border-gray-300 px-4 py-3 font-medium">18.5 - 24.9</td>
                                    <td class="border border-gray-300 px-4 py-3 text-green-700" data-i18n="normal">
                                        ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥</td>
                                </tr>
                                <tr class="bg-yellow-50">
                                    <td class="border border-gray-300 px-4 py-3 font-medium">25.0 - 29.9</td>
                                    <td class="border border-gray-300 px-4 py-3 text-yellow-700" data-i18n="overweight">
                                        ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô</td>
                                </tr>
                                <tr class="bg-red-50">
                                    <td class="border border-gray-300 px-4 py-3 font-medium">‚â• 30.0</td>
                                    <td class="border border-gray-300 px-4 py-3 text-red-700" data-i18n="obese">‡∏≠‡πâ‡∏ß‡∏ô
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Result Section -->
        <section id="result" class="fade-in hidden mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 sm:p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6 text-center" data-i18n="resultTitle">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå BMI
                    ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- BMI Result -->
                    <div class="text-center space-y-4">
                        <div class="bg-gray-50 rounded-lg p-6">
                            <div class="text-4xl font-bold mb-2" id="bmiValue">-</div>
                            <div class="text-lg font-medium mb-2" id="bmiCategory">-</div>
                            <div class="text-sm text-gray-600" id="bmiDescription">-</div>
                        </div>

                        <!-- Comparison with Average -->
                        <div id="comparisonSection" class="bg-blue-50 rounded-lg p-4 text-sm hidden">
                            <div class="font-semibold mb-2" data-i18n="comparisonTitle">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                            <div id="comparisonText" class="text-blue-800"></div>
                        </div>

                        <!-- Personal Advice -->
                        <div id="personalAdvice" class="bg-green-50 rounded-lg p-4 text-sm text-green-800 hidden">
                            <strong data-i18n="personalAdviceTitle">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:</strong>
                            <div id="adviceText" class="mt-2"></div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="grid grid-cols-2 gap-3 mt-6">
                            <button onclick="shareResult()"
                                class="action-button bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-md"
                                data-i18n="copyResult">
                                üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                            </button>
                            <button onclick="downloadPDF()"
                                class="action-button bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-md"
                                data-i18n="downloadPDF">
                                üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
                            </button>
                            <button onclick="shareFacebook()"
                                class="action-button bg-blue-800 hover:bg-blue-900 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-md"
                                data-i18n="shareFacebook">
                                üìò ‡πÅ‡∏ä‡∏£‡πå Facebook
                            </button>
                            <button onclick="saveToHistory()"
                                class="action-button bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-md"
                                data-i18n="saveHistory">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                            </button>
                        </div>
                    </div>

                    <!-- BMI Chart -->
                    <div class="flex flex-col items-center">
                        <h4 class="text-lg font-medium text-gray-700 mb-4" data-i18n="chartTitle">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                        </h4>
                        <div class="w-full max-w-sm">
                            <canvas id="bmiChart" width="300" height="250"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- History Section -->
        <section id="historySection" class="bg-white rounded-xl shadow-lg p-6 sm:p-8 mb-8 hidden">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold text-gray-800" data-i18n="historyTitle">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
                <button onclick="clearHistory()" class="text-red-600 hover:text-red-700 text-sm font-medium"
                    data-i18n="clearHistory">
                    üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                </button>
            </div>
            <div id="historyList" class="space-y-3"></div>
        </section>

        <!-- AdSense Section -->
        <section class="mb-8 hidden" id="adsense-section">
            <div class="bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                <div class="text-gray-500 mb-2">üì¢ Google AdSense</div>
                <div class="text-sm text-gray-400" data-i18n="adPlaceholder">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (728x90 ‡∏´‡∏£‡∏∑‡∏≠
                    Responsive)</div>
                <div class="text-xs text-gray-300 mt-2"><!-- Ads here --></div>
            </div>
        </section>

        <!-- Article Section -->
        <article class="bg-white rounded-xl shadow-lg p-6 sm:p-8" id="article-section">
            <!-- Thai Article -->
            <div id="article-th">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">BMI ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</h2>
                <div class="prose prose-gray max-w-none">
                    <p class="text-gray-700 leading-relaxed mb-4">
                        <strong>BMI (Body Mass Index)</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢</strong>
                        ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢
                        ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏™‡∏π‡∏ï‡∏£ BMI = ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.) √∑
                        ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á¬≤ (‡πÄ‡∏°‡∏ï‡∏£)
                        ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¥‡∏°‡∏û‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏• ‡∏™‡∏π‡∏ï‡∏£‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô BMI = (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å(‡∏õ‡∏≠‡∏ô‡∏î‡πå) √ó 703) √∑ ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á¬≤(‡∏ô‡∏¥‡πâ‡∏ß)
                    </p>
                    <p class="text-gray-700 leading-relaxed mb-4">
                        ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡πà‡∏≤ BMI ‡πÅ‡∏ö‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 4 ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏´‡∏•‡∏±‡∏Å ‡∏Ñ‡∏∑‡∏≠ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 18.5), ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥
                        (18.5-24.9),
                        ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô (25-29.9) ‡πÅ‡∏•‡∏∞‡∏≠‡πâ‡∏ß‡∏ô (30 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å (kg/cm)
                        ‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡∏°‡∏û‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏• (lb/ft/in)
                        ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏®‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Å‡∏≤‡∏£‡∏£‡∏π‡πâ‡∏Ñ‡πà‡∏≤ BMI ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
                        ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
                    </p>
                </div>
            </div>

            <!-- English Article -->
            <div id="article-en" class="hidden">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">What is BMI?</h2>
                <div class="prose prose-gray max-w-none">
                    <p class="text-gray-700 leading-relaxed mb-4">
                        <strong>BMI (Body Mass Index)</strong> is a measurement that uses your height and weight to
                        determine if your weight is within a healthy range.
                        It's calculated using the formula: BMI = weight (kg) √∑ height¬≤ (meters) for metric units, or BMI
                        = (weight(lbs) √ó 703) √∑ height¬≤(inches) for imperial units.
                    </p>
                    <p class="text-gray-700 leading-relaxed mb-4">
                        BMI categories are typically divided into four main ranges: underweight (below 18.5), normal
                        weight (18.5-24.9),
                        overweight (25-29.9), and obese (30 and above). Our calculator supports both metric (kg/cm) and
                        imperial (lb/ft/in) units,
                        providing personalized recommendations based on gender and age. While BMI is a useful screening
                        tool for weight categories
                        that may lead to health problems, it should be used alongside professional medical advice for
                        accurate health assessment.
                    </p>
                </div>
            </div>
        </article>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="text-center text-gray-600 text-sm">
                <p>&copy; 2025 BMI Calculator Pro | <span data-i18n="footerDisclaimer">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                        ‡πÑ‡∏°‡πà‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</span></p>
            </div>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // ============================================================================
        // INTERNATIONALIZATION (i18n)
        // ============================================================================
        const i18n = {
            th: {
                // Page Meta
                pageTitle: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö kg/lb",
                pageDescription: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ü‡∏£‡∏µ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•",

                // Header
                mainTitle: "üè• ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI Pro",
                mainSubtitle: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏°‡∏ß‡∏•‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢ kg/cm ‡πÅ‡∏•‡∏∞ lb/ft/inch",

                // Calculator
                calcTitle: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
                calcSubtitle: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û",
                weightLabel: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)",
                weightLabelImperial: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏õ‡∏≠‡∏ô‡∏î‡πå)",
                heightLabel: "‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£)",
                heightImperialLabel: "‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á",
                feetPlaceholder: "‡∏ü‡∏∏‡∏ï",
                inchesPlaceholder: "‡∏ô‡∏¥‡πâ‡∏ß",
                genderLabel: "‡πÄ‡∏û‡∏® (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
                ageLabel: "‡∏≠‡∏≤‡∏¢‡∏∏ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
                selectGender: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®",
                male: "‡∏ä‡∏≤‡∏¢",
                female: "‡∏´‡∏ç‡∏¥‡∏á",
                agePlaceholder: "‡∏õ‡∏µ",
                calculateBtn: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI",

                // Table
                bmiTableTitle: "‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤ BMI",
                bmiRange: "‡∏Ñ‡πà‡∏≤ BMI",
                interpretation: "‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°",
                underweight: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢",
                normal: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥",
                overweight: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô",
                obese: "‡∏≠‡πâ‡∏ß‡∏ô",

                // Results
                resultTitle: "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
                chartTitle: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
                comparisonTitle: "‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢",
                personalAdviceTitle: "‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:",

                // Actions
                copyResult: "üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå",
                downloadPDF: "üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF",
                shareFacebook: "üìò ‡πÅ‡∏ä‡∏£‡πå Facebook",
                saveHistory: "üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",

                // History
                historyTitle: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì",
                clearHistory: "üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
                noHistory: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì",

                // PWA
                installApp: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ",
                installAppDesc: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô",
                install: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á",

                // Misc
                adPlaceholder: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (728x90 ‡∏´‡∏£‡∏∑‡∏≠ Responsive)",
                footerDisclaimer: "‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå",

                // BMI Categories
                bmi_underweight: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢",
                bmi_normal: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥",
                bmi_overweight: "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô",
                bmi_obese: "‡∏≠‡πâ‡∏ß‡∏ô",

                // BMI Descriptions
                desc_underweight: "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å",
                desc_normal: "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏õ",
                desc_overweight: "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å",
                desc_obese: "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢"
            },
            en: {
                // Page Meta
                pageTitle: "Free Online BMI Calculator - Health Body Mass Index Checker kg/lb",
                pageDescription: "Free online BMI calculator supporting kg/cm and lb/ft/inch units with chart visualization, comparison table, and personalized recommendations",

                // Header
                mainTitle: "üè• BMI Calculator Pro",
                mainSubtitle: "Comprehensive body mass index checker supporting kg/cm and lb/ft/inch units",

                // Calculator
                calcTitle: "Calculate Your BMI",
                calcSubtitle: "Select units and enter your information to check your health",
                weightLabel: "Weight (kilograms)",
                weightLabelImperial: "Weight (pounds)",
                heightLabel: "Height (centimeters)",
                heightImperialLabel: "Height",
                feetPlaceholder: "Feet",
                inchesPlaceholder: "Inches",
                genderLabel: "Gender (optional)",
                ageLabel: "Age (optional)",
                selectGender: "Select Gender",
                male: "Male",
                female: "Female",
                agePlaceholder: "Years",
                calculateBtn: "Calculate BMI",

                // Table
                bmiTableTitle: "BMI Comparison Table",
                bmiRange: "BMI Range",
                interpretation: "Interpretation",
                underweight: "Underweight",
                normal: "Normal Weight",
                overweight: "Overweight",
                obese: "Obese",

                // Results
                resultTitle: "Your BMI Results",
                chartTitle: "Your BMI Position",
                comparisonTitle: "Comparison with Average",
                personalAdviceTitle: "Personal Recommendations:",

                // Actions
                copyResult: "üìã Copy Result",
                downloadPDF: "üìÑ Download PDF",
                shareFacebook: "üìò Share Facebook",
                saveHistory: "üíæ Save History",

                // History
                historyTitle: "Calculation History",
                clearHistory: "üóëÔ∏è Clear History",
                noHistory: "No calculation history yet",

                // PWA
                installApp: "Install App",
                installAppDesc: "Install as mobile app for easier access",
                install: "Install",

                // Misc
                adPlaceholder: "Advertisement space (728x90 or Responsive)",
                footerDisclaimer: "For reference only, not a substitute for medical advice",

                // BMI Categories
                bmi_underweight: "Underweight",
                bmi_normal: "Normal Weight",
                bmi_overweight: "Overweight",
                bmi_obese: "Obese",

                // BMI Descriptions
                desc_underweight: "You are underweight. Consider consulting a healthcare provider to determine the cause and plan for healthy weight gain.",
                desc_normal: "Congratulations! Your weight is in the normal range. Maintain your current weight with a healthy lifestyle.",
                desc_overweight: "You are overweight. Consider controlling your diet and exercising regularly to lose weight.",
                desc_obese: "You are obese. It's recommended to consult a healthcare provider for a safe weight loss plan."
            }
        };

        // ============================================================================
        // GLOBAL VARIABLES
        // ============================================================================
        let currentLang = 'th';
        let currentUnit = 'metric';
        let bmiChart = null;
        let lastBMIResult = null;
        let deferredPrompt = null;

        // Average BMI data by age and gender
        const bmiAverages = {
            male: {
                '18-24': 22.8, '25-34': 24.5, '35-44': 25.2, '45-54': 25.8, '55+': 25.5
            },
            female: {
                '18-24': 22.1, '25-34': 23.8, '35-44': 24.5, '45-54': 25.2, '55+': 25.1
            }
        };

        // ============================================================================
        // INITIALIZATION
        // ============================================================================
        document.addEventListener('DOMContentLoaded', function () {
            // Load saved preferences
            loadPreferences();

            // Setup event listeners
            setupEventListeners();

            // Load history
            loadHistory();

            // Setup PWA
            setupPWA();

            // Apply current language
            applyLanguage();
        });

        // ============================================================================
        // LANGUAGE SWITCHING
        // ============================================================================
        function switchLanguage(lang) {
            currentLang = lang;

            // Update UI
            document.getElementById('thBtn').classList.toggle('active', lang === 'th');
            document.getElementById('enBtn').classList.toggle('active', lang === 'en');

            // Update HTML lang attribute
            document.documentElement.lang = lang;

            // Apply translations
            applyLanguage();

            // Save preference
            localStorage.setItem('bmi_lang', lang);

            // Hide result when switching languages
            hideResult();
        }

        function applyLanguage() {
            const texts = i18n[currentLang];

            // Update page meta
            document.getElementById('pageTitle').textContent = texts.pageTitle;
            document.getElementById('pageDescription').content = texts.pageDescription;
            document.getElementById('ogTitle').content = texts.pageTitle;
            document.getElementById('ogDescription').content = texts.pageDescription;
            document.getElementById('twitterTitle').content = texts.pageTitle;
            document.getElementById('twitterDescription').content = texts.pageDescription;

            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (texts[key]) {
                    element.textContent = texts[key];
                }
            });

            // Update placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (texts[key]) {
                    element.placeholder = texts[key];
                }
            });

            // Update weight label based on current unit
            updateWeightLabel();

            // Show/hide articles based on language
            document.getElementById('article-th').classList.toggle('hidden', currentLang !== 'th');
            document.getElementById('article-en').classList.toggle('hidden', currentLang !== 'en');

            // Update history if visible
            if (!document.getElementById('historySection').classList.contains('hidden')) {
                displayHistory();
            }
        }

        function updateWeightLabel() {
            const texts = i18n[currentLang];
            const label = currentUnit === 'metric' ? texts.weightLabel : texts.weightLabelImperial;
            document.getElementById('weightLabel').textContent = label;
        }

        // ============================================================================
        // UNIT SWITCHING
        // ============================================================================
        function switchUnit(unit) {
            currentUnit = unit;

            // Update UI
            document.getElementById('metricBtn').classList.toggle('active', unit === 'metric');
            document.getElementById('imperialBtn').classList.toggle('active', unit === 'imperial');

            // Toggle input fields
            document.getElementById('metricHeight').classList.toggle('hidden', unit !== 'metric');
            document.getElementById('imperialHeight').classList.toggle('hidden', unit !== 'imperial');

            // Update labels and placeholders
            updateWeightLabel();
            const texts = i18n[currentLang];

            if (unit === 'metric') {
                document.getElementById('weight').placeholder = currentLang === 'th' ? '‡πÄ‡∏ä‡πà‡∏ô 65' : 'e.g. 65';
            } else {
                document.getElementById('weight').placeholder = currentLang === 'th' ? '‡πÄ‡∏ä‡πà‡∏ô 143' : 'e.g. 143';
            }

            // Clear inputs when switching
            clearInputs();
            hideResult();

            // Save preference
            localStorage.setItem('bmi_unit', unit);
        }

        function clearInputs() {
            document.getElementById('weight').value = '';
            document.getElementById('height').value = '';
            document.getElementById('heightFeet').value = '';
            document.getElementById('heightInches').value = '';
        }

        // ============================================================================
        // BMI CALCULATION
        // ============================================================================
        function calculateBMI() {
            let weight, heightInMeters;

            if (currentUnit === 'metric') {
                weight = parseFloat(document.getElementById('weight').value);
                const heightCm = parseFloat(document.getElementById('height').value);

                if (!weight || !heightCm || weight <= 0 || heightCm <= 0) {
                    const texts = i18n[currentLang];
                    alert(currentLang === 'th' ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : 'Please enter valid weight and height');
                    return;
                }

                heightInMeters = heightCm / 100;

            } else {
                const weightLbs = parseFloat(document.getElementById('weight').value);
                const feet = parseFloat(document.getElementById('heightFeet').value);
                const inches = parseFloat(document.getElementById('heightInches').value) || 0;

                if (!weightLbs || !feet || weightLbs <= 0 || feet <= 0) {
                    alert(currentLang === 'th' ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : 'Please enter valid weight and height');
                    return;
                }

                // Convert to metric
                weight = weightLbs * 0.453592; // lbs to kg
                const totalInches = (feet * 12) + inches;
                heightInMeters = totalInches * 0.0254; // inches to meters
            }

            // Calculate BMI
            const bmi = weight / (heightInMeters * heightInMeters);

            // Store result
            lastBMIResult = {
                bmi: bmi,
                weight: weight,
                height: heightInMeters * 100, // store in cm
                unit: currentUnit,
                gender: document.getElementById('gender').value,
                age: parseInt(document.getElementById('age').value),
                timestamp: new Date().getTime()
            };

            // Display results
            displayBMIResult(bmi);
        }

        function displayBMIResult(bmi) {
            const resultDiv = document.getElementById('result');
            const bmiValueDiv = document.getElementById('bmiValue');
            const bmiCategoryDiv = document.getElementById('bmiCategory');
            const bmiDescriptionDiv = document.getElementById('bmiDescription');

            // Round BMI to 1 decimal place
            const roundedBMI = Math.round(bmi * 10) / 10;

            // Determine BMI category and styling
            let category, description, colorClass, chartColor;
            const texts = i18n[currentLang];

            if (bmi < 18.5) {
                category = texts.bmi_underweight;
                description = texts.desc_underweight;
                colorClass = 'text-blue-600';
                chartColor = '#3B82F6';
            } else if (bmi >= 18.5 && bmi < 25) {
                category = texts.bmi_normal;
                description = texts.desc_normal;
                colorClass = 'text-green-600';
                chartColor = '#10B981';
            } else if (bmi >= 25 && bmi < 30) {
                category = texts.bmi_overweight;
                description = texts.desc_overweight;
                colorClass = 'text-yellow-600';
                chartColor = '#F59E0B';
            } else {
                category = texts.bmi_obese;
                description = texts.desc_obese;
                colorClass = 'text-red-600';
                chartColor = '#EF4444';
            }

            // Update display
            bmiValueDiv.textContent = roundedBMI;
            bmiValueDiv.className = `text-4xl font-bold mb-2 ${colorClass}`;
            bmiCategoryDiv.textContent = category;
            bmiCategoryDiv.className = `text-lg font-medium mb-2 ${colorClass}`;
            bmiDescriptionDiv.textContent = description;

            // Show comparison with average
            showComparison(bmi);

            // Show personal advice
            showPersonalAdvice(bmi);

            // Create BMI chart
            createBMIChart(bmi, chartColor);

            // Show result with animation
            resultDiv.classList.remove('hidden');
            setTimeout(() => {
                resultDiv.classList.add('show');
            }, 10);

            // Scroll to result
            setTimeout(() => {
                resultDiv.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }, 300);
        }

        function showComparison(bmi) {
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);
            const comparisonSection = document.getElementById('comparisonSection');
            const comparisonText = document.getElementById('comparisonText');

            if (!gender || !age) {
                comparisonSection.classList.add('hidden');
                return;
            }

            // Determine age group
            let ageGroup;
            if (age >= 18 && age <= 24) ageGroup = '18-24';
            else if (age >= 25 && age <= 34) ageGroup = '25-34';
            else if (age >= 35 && age <= 44) ageGroup = '35-44';
            else if (age >= 45 && age <= 54) ageGroup = '45-54';
            else if (age >= 55) ageGroup = '55+';
            else {
                comparisonSection.classList.add('hidden');
                return;
            }

            const avgBMI = bmiAverages[gender][ageGroup];
            const diff = bmi - avgBMI;
            const absDiff = Math.abs(diff);

            let comparisonMsg;
            if (currentLang === 'th') {
                if (absDiff < 1) {
                    comparisonMsg = `BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏¢‡∏∏ ${ageGroup} ‡∏õ‡∏µ ‡πÄ‡∏û‡∏®${gender === 'male' ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á'} (${avgBMI.toFixed(1)})`;
                } else if (diff > 0) {
                    comparisonMsg = `BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏¢‡∏∏ ${ageGroup} ‡∏õ‡∏µ ‡πÄ‡∏û‡∏®${gender === 'male' ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á'} ${absDiff.toFixed(1)} ‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${avgBMI.toFixed(1)})`;
                } else {
                    comparisonMsg = `BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏¢‡∏∏ ${ageGroup} ‡∏õ‡∏µ ‡πÄ‡∏û‡∏®${gender === 'male' ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á'} ${absDiff.toFixed(1)} ‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${avgBMI.toFixed(1)})`;
                }
            } else {
                const genderStr = gender === 'male' ? 'male' : 'female';
                if (absDiff < 1) {
                    comparisonMsg = `Your BMI is close to the average for ${genderStr}s aged ${ageGroup} years (${avgBMI.toFixed(1)})`;
                } else if (diff > 0) {
                    comparisonMsg = `Your BMI is ${absDiff.toFixed(1)} points higher than the average for ${genderStr}s aged ${ageGroup} years (average: ${avgBMI.toFixed(1)})`;
                } else {
                    comparisonMsg = `Your BMI is ${absDiff.toFixed(1)} points lower than the average for ${genderStr}s aged ${ageGroup} years (average: ${avgBMI.toFixed(1)})`;
                }
            }

            comparisonText.textContent = comparisonMsg;
            comparisonSection.classList.remove('hidden');
        }

        function showPersonalAdvice(bmi) {
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);
            const adviceDiv = document.getElementById('personalAdvice');
            const adviceText = document.getElementById('adviceText');

            if (!gender && !age) {
                adviceDiv.classList.add('hidden');
                return;
            }

            let advice = '';

            if (currentLang === 'th') {
                if (age && age < 18) {
                    advice = '‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏° BMI ‡∏≠‡∏≤‡∏à‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°';
                } else if (age && age > 65) {
                    advice = '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏≠‡∏≤‡∏à‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏ß‡∏•‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°';
                } else if (gender === 'female' && bmi >= 18.5 && bmi < 25) {
                    advice = '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÇ‡∏£‡∏Ñ‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡∏û‡∏£‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Æ‡∏≠‡∏£‡πå‡πÇ‡∏°‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠';
                } else if (gender === 'male' && bmi >= 25) {
                    advice = '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠';
                } else {
                    advice = '‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö BMI ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ ‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏î‡∏∏‡∏• ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ';
                }
            } else {
                if (age && age < 18) {
                    advice = 'As a teenager, BMI interpretation may differ from adults. Consider consulting a pediatrician for appropriate growth assessment.';
                } else if (age && age > 65) {
                    advice = 'For older adults, being slightly above normal weight may help prevent muscle mass loss. Consult a healthcare provider for an appropriate health plan.';
                } else if (gender === 'female' && bmi >= 18.5 && bmi < 25) {
                    advice = 'For women, maintaining a normal weight range helps reduce the risk of osteoporosis and hormonal issues. Regular exercise is recommended.';
                } else if (gender === 'male' && bmi >= 25) {
                    advice = 'For men, excess weight may increase the risk of heart disease and diabetes. Focus on aerobic exercise and muscle building.';
                } else {
                    advice = 'Good health doesn\'t depend solely on BMI. Consider regular exercise, balanced nutrition, and annual health check-ups.';
                }
            }

            if (advice) {
                adviceText.textContent = advice;
                adviceDiv.classList.remove('hidden');
            } else {
                adviceDiv.classList.add('hidden');
            }
        }

        // ============================================================================
        // CHART CREATION
        // ============================================================================
        function createBMIChart(userBMI, color) {
            const ctx = document.getElementById('bmiChart').getContext('2d');

            // Destroy existing chart
            if (bmiChart) {
                bmiChart.destroy();
            }

            // Chart data
            const texts = i18n[currentLang];
            const categories = [texts.bmi_underweight, texts.bmi_normal, texts.bmi_overweight, texts.bmi_obese];
            const ranges = [18.5, 24.9, 29.9, 40];
            const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444'];
            const backgroundColors = colors.map(c => c + '20'); // Add transparency

            // Find user's category
            let userCategory = 0;
            if (userBMI >= 18.5 && userBMI < 25) userCategory = 1;
            else if (userBMI >= 25 && userBMI < 30) userCategory = 2;
            else if (userBMI >= 30) userCategory = 3;

            // Highlight user's category
            const chartColors = backgroundColors.map((c, i) => i === userCategory ? colors[i] : c);

            bmiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [{
                        label: currentLang === 'th' ? '‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡πà‡∏≤ BMI' : 'BMI Range',
                        data: ranges,
                        backgroundColor: chartColors,
                        borderColor: colors,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const ranges = ['< 18.5', '18.5 - 24.9', '25.0 - 29.9', '‚â• 30.0'];
                                    return `${context.label}: ${ranges[context.dataIndex]}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 40,
                            title: {
                                display: true,
                                text: currentLang === 'th' ? '‡∏Ñ‡πà‡∏≤ BMI' : 'BMI Value'
                            }
                        }
                    },
                    plugins: {
                        // Custom plugin to draw user BMI line
                        afterDraw: function (chart) {
                            const ctx = chart.ctx;
                            const chartArea = chart.chartArea;
                            const yScale = chart.scales.y;

                            // Calculate Y position for user BMI
                            const yPos = yScale.getPixelForValue(userBMI);

                            // Draw line
                            ctx.save();
                            ctx.strokeStyle = color;
                            ctx.lineWidth = 3;
                            ctx.setLineDash([5, 5]);
                            ctx.beginPath();
                            ctx.moveTo(chartArea.left, yPos);
                            ctx.lineTo(chartArea.right, yPos);
                            ctx.stroke();

                            // Draw label
                            ctx.fillStyle = color;
                            ctx.font = 'bold 12px Arial';
                            const label = currentLang === 'th' ? `‡∏Ñ‡∏∏‡∏ì: ${userBMI.toFixed(1)}` : `You: ${userBMI.toFixed(1)}`;
                            ctx.fillText(label, chartArea.right - 60, yPos - 5);
                            ctx.restore();
                        }
                    }
                }
            });
        }

        // ============================================================================
        // HISTORY MANAGEMENT
        // ============================================================================
        function saveToHistory() {
            if (!lastBMIResult) return;

            let history = JSON.parse(localStorage.getItem('bmi_history') || '[]');

            // Add current result to history
            history.unshift(lastBMIResult);

            // Keep only last 10 records
            history = history.slice(0, 10);

            // Save to localStorage
            localStorage.setItem('bmi_history', JSON.stringify(history));

            // Show success message
            const msg = currentLang === 'th' ? '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!' : 'History saved successfully!';
            alert(msg);

            // Update history display
            loadHistory();
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('bmi_history') || '[]');

            if (history.length > 0) {
                document.getElementById('historySection').classList.remove('hidden');
                displayHistory();
            }
        }

        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('bmi_history') || '[]');
            const historyList = document.getElementById('historyList');
            const texts = i18n[currentLang];

            if (history.length === 0) {
                historyList.innerHTML = `<p class="text-gray-500 text-center">${texts.noHistory}</p>`;
                return;
            }

            historyList.innerHTML = history.map((record, index) => {
                const date = new Date(record.timestamp).toLocaleDateString(currentLang === 'th' ? 'th-TH' : 'en-US');
                const time = new Date(record.timestamp).toLocaleTimeString(currentLang === 'th' ? 'th-TH' : 'en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                let category;
                if (record.bmi < 18.5) category = texts.bmi_underweight;
                else if (record.bmi < 25) category = texts.bmi_normal;
                else if (record.bmi < 30) category = texts.bmi_overweight;
                else category = texts.bmi_obese;

                const weight = record.unit === 'metric' ?
                    `${(record.weight).toFixed(1)} kg` :
                    `${(record.weight / 0.453592).toFixed(1)} lbs`;

                const height = record.unit === 'metric' ?
                    `${record.height.toFixed(0)} cm` :
                    `${Math.floor(record.height / 30.48)}'${Math.round((record.height % 30.48) / 2.54)}"`;

                return `
                    <div class="history-item bg-gray-50 rounded-lg p-4 border border-gray-200">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center space-x-4 mb-2">
                                    <span class="text-2xl font-bold">${record.bmi.toFixed(1)}</span>
                                    <span class="px-3 py-1 rounded-full text-sm font-medium ${record.bmi < 18.5 ? 'bg-blue-100 text-blue-800' :
                        record.bmi < 25 ? 'bg-green-100 text-green-800' :
                            record.bmi < 30 ? 'bg-yellow-100 text-yellow-800' :
                                'bg-red-100 text-red-800'
                    }">${category}</span>
                                </div>
                                <div class="text-sm text-gray-600 mb-1">
                                    ${weight} ‚Ä¢ ${height}
                                    ${record.gender ? ` ‚Ä¢ ${record.gender === 'male' ? (currentLang === 'th' ? '‡∏ä‡∏≤‡∏¢' : 'Male') : (currentLang === 'th' ? '‡∏´‡∏ç‡∏¥‡∏á' : 'Female')}` : ''}
                                    ${record.age ? ` ‚Ä¢ ${record.age} ${currentLang === 'th' ? '‡∏õ‡∏µ' : 'years'}` : ''}
                                </div>
                                <div class="text-xs text-gray-500">${date} ${time}</div>
                            </div>
                            <button onclick="deleteHistoryItem(${index})" class="text-red-500 hover:text-red-700 ml-4">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9zM4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 102 0v3a1 1 0 11-2 0V9zm4 0a1 1 0 10-2 0v3a1 1 0 102 0V9z" clip-rule="evenodd"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function deleteHistoryItem(index) {
            let history = JSON.parse(localStorage.getItem('bmi_history') || '[]');
            history.splice(index, 1);
            localStorage.setItem('bmi_history', JSON.stringify(history));

            if (history.length === 0) {
                document.getElementById('historySection').classList.add('hidden');
            } else {
                displayHistory();
            }
        }

        function clearHistory() {
            const msg = currentLang === 'th' ? '‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?' : 'Are you sure you want to clear all history?';
            if (confirm(msg)) {
                localStorage.removeItem('bmi_history');
                document.getElementById('historySection').classList.add('hidden');

                const successMsg = currentLang === 'th' ? '‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!' : 'History cleared successfully!';
                alert(successMsg);
            }
        }

        // ============================================================================
        // SHARING FUNCTIONS
        // ============================================================================
        function shareResult() {
            if (!lastBMIResult) return;

            const bmi = lastBMIResult.bmi.toFixed(1);
            let category;
            const texts = i18n[currentLang];

            if (lastBMIResult.bmi < 18.5) category = texts.bmi_underweight;
            else if (lastBMIResult.bmi < 25) category = texts.bmi_normal;
            else if (lastBMIResult.bmi < 30) category = texts.bmi_overweight;
            else category = texts.bmi_obese;

            const text = currentLang === 'th' ?
                `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à BMI ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô: ${bmi} (${category})\n\n‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: ${window.location.href}` :
                `My BMI Result: ${bmi} (${category})\n\nCalculate your BMI at: ${window.location.href}`;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    const msg = currentLang === 'th' ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!' : 'Result copied to clipboard!';
                    alert(msg);
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                const msg = currentLang === 'th' ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!' : 'Result copied to clipboard!';
                alert(msg);
            }
        }

        function shareFacebook() {
            if (!lastBMIResult) return;

            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(currentLang === 'th' ?
                `‡∏°‡∏≤‡∏ï‡∏£‡∏ß‡∏à BMI ‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞! ‡∏â‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏•‡πâ‡∏ß` :
                `Check your BMI! I just got my results`);

            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank', 'width=600,height=400');
        }

        function downloadPDF() {
            if (!lastBMIResult) return;

            // Get result section
            const resultSection = document.getElementById('result');

            // Use html2canvas to capture the result section
            html2canvas(resultSection, {
                backgroundColor: '#ffffff',
                scale: 2
            }).then(canvas => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');

                // Add title
                pdf.setFontSize(20);
                const title = currentLang === 'th' ? '‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à BMI' : 'BMI Test Results';
                pdf.text(title, 20, 20);

                // Add date
                pdf.setFontSize(12);
                const date = new Date().toLocaleDateString(currentLang === 'th' ? 'th-TH' : 'en-US');
                pdf.text(date, 20, 30);

                // Add canvas image
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 170;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 20, 40, imgWidth, imgHeight);

                // Add disclaimer
                pdf.setFontSize(10);
                const disclaimer = currentLang === 'th' ?
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå' :
                    'Note: This result is for reference only and does not substitute medical advice';

                pdf.text(disclaimer, 20, 280);

                // Save PDF
                const filename = currentLang === 'th' ? 'BMI-‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå.pdf' : 'BMI-Results.pdf';
                pdf.save(filename);
            });
        }

        // ============================================================================
        // PWA FUNCTIONS
        // ============================================================================
        function setupPWA() {
            // Register service worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('data:text/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdibWktY2FsY3VsYXRvci12MSc7CmNvbnN0IHVybHNUb0NhY2hlID0gWwogICcvJwpdOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbCgKICAgIGNhY2hlcy5vcGVuKENBQ0hFX05BTUUpCiAgICAgIC50aGVuKGNhY2hlID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpCiAgKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKAogICAgY2FjaGVzLm1hdGNoKGV2ZW50LnJlcXVlc3QpCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlIHx8IGZldGNoKGV2ZW50LnJlcXVlc3QpKQogICk7Cn0pOw==')
                    .then(() => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed'));
            }

            // Handle PWA install
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('installPrompt').classList.remove('hidden');
            });
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('PWA installed');
                    }
                    deferredPrompt = null;
                    hideInstallPrompt();
                });
            }
        }

        function hideInstallPrompt() {
            document.getElementById('installPrompt').classList.add('hidden');
        }

        // ============================================================================
        // UTILITY FUNCTIONS
        // ============================================================================
        function hideResult() {
            const resultDiv = document.getElementById('result');
            if (!resultDiv.classList.contains('hidden')) {
                resultDiv.classList.remove('show');
                setTimeout(() => {
                    resultDiv.classList.add('hidden');
                }, 300);
            }
        }

        function loadPreferences() {
            // Load language preference
            const savedLang = localStorage.getItem('bmi_lang');
            if (savedLang) {
                switchLanguage(savedLang);
            }

            // Load unit preference
            const savedUnit = localStorage.getItem('bmi_unit');
            if (savedUnit) {
                switchUnit(savedUnit);
            }
        }

        function setupEventListeners() {
            // Allow Enter key to trigger calculation
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        calculateBMI();
                    }
                });

                // Hide result when inputs change
                input.addEventListener('input', hideResult);
            });

            // Also hide result when gender/age changes
            document.getElementById('gender').addEventListener('change', hideResult);
            document.getElementById('age').addEventListener('input', hideResult);
        }
    </script>
</body>

</html>